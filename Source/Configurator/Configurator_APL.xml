<?xml version="1.0" encoding="utf-8"?>
<!--GoogleMaps plugin additions-->
<root xmlns:android="http://schemas.android.com/apk/res/android">
	<androidManifestUpdates>
		<addElements tag="application">
      <provider android:name="android.support.v4.content.FileProvider" android:authorities="com.luxario.configurator.fileprovider" android:exported="false" android:grantUriPermissions="true">
        <meta-data android:name="android.support.FILE_PROVIDER_PATHS" android:resource="@xml/file_provider_paths" />
      </provider>
    </addElements>

		<addElements tag="manifest">
      <!--uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
      <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" /-->
		</addElements>	
	</androidManifestUpdates>
  <prebuildCopies>
    <copyDir src="$S(PluginDir)/java" dst="$S(BuildDir)" />
  </prebuildCopies>
	<proguardAdditions>
    	<insert>
    		-keep class * extends java.util.ListResourceBundle {
			    protected Object[][] getContents();
			}

			-keep public class com.google.android.gms.common.internal.safeparcel.SafeParcelable {
			    public static final *** NULL;
			}

			-keepnames @com.google.android.gms.common.annotation.KeepName class *
			-keepclassmembernames class * {
			    @com.google.android.gms.common.annotation.KeepName *;
			}

			-keepnames class * implements android.os.Parcelable {
			    public static final ** CREATOR;
			}
	    </insert>
	</proguardAdditions>
	
	<gameActivityImportAdditions>
		<insert>
      import android.util.Log;
      import android.os.Bundle;
      import android.app.ActivityManager;
      import android.widget.Toast;
    </insert>
	</gameActivityImportAdditions>
	<gameActivityOnStartAdditions>
		<insert>
		</insert>
	</gameActivityOnStartAdditions>
	<gameActivityOnCreateAdditions>
		<insert>
		</insert>
	</gameActivityOnCreateAdditions>
	<gameActivityClassAdditions>
		<insert>
      private static final int REQUEST_CHECK_SETTINGS = 0x1;
      private Intent serviceIntent;
      private boolean startedWithServiceRunning;

      public void AndroidThunkJava_CreateGoogleMap(final boolean trackingEnabled,
      final float posX, final float posY,
      final float sizeX, final float sizeY, float renderX) {
      Log.debug("In AndroidThunkJava_CreateGoogleMap");
      DisplayMetrics dm = getResources().getDisplayMetrics();
      final float scale = dm.widthPixels / renderX;
      Log.debug("dm:" + dm.widthPixels + "render:" + renderX);

      Log.debug("new UEMapDialog");
      _activity.runOnUiThread(new Runnable() {
      public void run() {
      //mMapDialog = new UEMapDialog(_activity,
      //	trackingEnabled, startedWithServiceRunning,
      //	(int)(posX * scale), (int) (posY * scale),
      //	(int) (sizeX * scale), (int) (sizeY * scale));
      //mMapDialog.show();
      }
      });
      }

      /*
      *
      *    String type = "image/*";
      *    String filename = "/myPhoto.jpg";
      *    String mediaPath = Environment.getExternalStorageDirectory() + filename;
      *    createInstagramIntent(type, mediaPath);
      */

      public void AndroidThunkJava_CreateInstagramIntent(final String type, final String mediaPath)
      {
      runOnUiThread(new Runnable() {
      @Override
      public void run() {
      Intent share = new Intent(Intent.ACTION_SEND);
      share.setType(type);
      File file = new File(mediaPath);
      Uri uri = FileProvider.getUriForFile(getApplicationContext(), "com.luxario.configurator.fileprovider", file);
      share.putExtra(Intent.EXTRA_STREAM, uri);
      share.setPackage("com.instagram.android");
      Intent newIntent = Intent.createChooser(share, "Share to");
      newIntent.setFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);
      startActivity(newIntent);
      }
      });
      }

    </insert>
	</gameActivityClassAdditions>

	<gameActivityOnActivityResultAdditions>	
		<insert>
		</insert>
	</gameActivityOnActivityResultAdditions>
	<gameActivityOnPauseAdditions>
		<insert>
		</insert>
	</gameActivityOnPauseAdditions>
	<gameActivityOnResumeAdditions>
		<insert>
		</insert>
	</gameActivityOnResumeAdditions>
</root>